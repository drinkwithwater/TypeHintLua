#!/usr/bin/lua

local function getcontents (filename)
  local file = assert(io.open(filename, "r"))
  local contents = file:read("*a")
  file:close()
  return contents
end

local filename = arg[1]
if not filename then
  print("usage : thd xxx.thlua")
end

local subject = getcontents(filename)

local CodeEnv = require "thlua.code.CodeEnv"
local env = CodeEnv.new(subject, filename)
local parser = require "thlua.code.parser"

local t1 = os.clock()
for i=1,40 do
	parser.parse(env, subject)
end
local t2 = os.clock()

print(t2-t1)
